<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.pakmall.mapper.MemberMapper">


	<!-- 아이디 중복 체크 -->
	<select id="checkIdDuplicate" resultType="int">
		select count(*)
		from memb_tbl
		where memb_id = #{memb_id}
	</select>
	
	<!-- 회원가입 -->
	<insert id="join" >
		insert into MEMB_TBL(memb_id, memb_pw, memb_pwck, memb_name, memb_phone, 
			memb_email, memb_zip, memb_addr1, memb_addr2)
		values(#{memb_id}, #{memb_pw}, #{memb_pwck}, #{memb_name}, #{memb_phone}, 
			#{memb_email}, #{memb_zip}, #{memb_addr1}, #{memb_addr2})
	</insert>
	
	<!-- 로그인 -->
	<select id="login_ok" resultType="com.pakmall.domain.MemberVO">
		select memb_id, memb_pw, memb_pwck, memb_name, memb_phone, memb_email, memb_zip, memb_addr1, memb_addr2 
		from memb_tbl 
		where memb_id = #{memb_id}
	</select>
	
	<!-- 회원정보 수정 폼 -->
	<select id="member_info" resultType="com.pakmall.domain.MemberVO">
    	select memb_id, memb_name, memb_phone, memb_email, memb_zip, memb_addr1, memb_addr2 
    	from memb_tbl where memb_id = #{memb_id}
	</select>
	
	<!-- 회원정보 수정 -->
	<update id="modifyPOST">    
	    update memb_tbl
	
	        set memb_email = #{memb_email}
	        ,   memb_phone = #{memb_phone}
	        ,   memb_zip = #{memb_zip}
	        ,   memb_addr1 = #{memb_addr1}
	        ,   memb_addr2 = #{memb_addr2}
	
	    where memb_id = #{memb_id}
	</update>
	
	<!-- 회원 삭제 -->
	<delete id="member_delete" >
		delete from memb_tbl where memb_id = #{memb_id}
	</delete>
	
	<!-- 아이디 찾기 -->
	<select id="find_id" resultType="string">
		select memb_id from memb_tbl where memb_name = #{memb_name}
	</select>
	
	<!-- 비밀번호 찾기 -->
	<select id="find_pwd" resultType="com.pakmall.domain.MemberVO">
		select memb_pw from memb_tbl where memb_id = #{memb_id} and memb_name = #{memb_name}
	</select>
	
	<!-- VO클래스 필드와 테이블컬럼명이 다른 경우 -->
	<resultMap  id="userinfo"  type="com.pakmall.domain.UserInfoVO" >
		
		<id property="user_id" column="memb_id" />
		<result property="user_id" column="memb_id" />
		<result property="user_pw" column="memb_pw" />
		<result property="user_pwck" column="memb_pwck" />
		<result property="user_name" column="memb_name" />
		<result property="user_phone" column="memb_phone" />
		<result property="user_email" column="memb_email" />
		<result property="user_zip" column="memb_zip" />
		<result property="user_addr1" column="memb_addr1" />
		<result property="user_addr2" column="memb_addr2" />
	
	</resultMap>
		
	<select id="userinfo_list" resultMap="userinfo">
		select
			memb_id, memb_pw, memb_pwck, memb_name, memb_phone, memb_email, memb_zip, memb_addr1, memb_addr2
		from memb_tbl
	</select>
	
	<update id="pw_search">
		update memb_tbl set memb_pw = #{memb_pw} where memb_id = #{memb_id}
	</update>

	<update id="updatePOST">
		update memb_tbl set memb_pw = #{memb_pw} where memb_id = #{memb_id}
	</update>
	

</mapper>